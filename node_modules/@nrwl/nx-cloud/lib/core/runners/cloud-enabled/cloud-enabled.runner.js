const a0_0x2334=['AGENT_RUNNING_IN_DISTRIBUTED_EXECUTION','../../terminal-output/output-obfuscator','FileStorage','forEach','endRun','__esModule','tasks','obfuscate','assign','next','VERBOSE_LOGGING','value','cacheDirectory','path','filter','all','TaskRunnerLifeCycle','getBranch','../../file-storage/file-storage','CloudRemoteCache','scan','then','EndOfRunMessage','ENCRYPTION_KEY','./task-runner-life-cycle','slice','rxjs/internal/Subject','stringify','toISOString','taskId','../../terminal-output/message-reporter','cloudEnabledTasksRunner','defineProperty','done','cacheableOperations','Agent\x20wasn\x27t\x20able\x20to\x20record\x20its\x20run','Subject','./cloud-remote-cache','E2EEncryption','printMessages','Agent\x20wasn\x27t\x20able\x20to\x20store\x20artifacts','hash','NX_CLOUD_DISTRIBUTED_EXECUTION_ID','../../file-storage/e2e-encryption','parseCommand','@nrwl/workspace/src/utilities/output','output','...','map','exit','@nrwl/workspace/src/tasks-runner/tasks-runner-v2','startRun','apply','NUMBER_OF_TRIES','complete','tasks-hashes','note','error','getMachineInfo'];(function(_0x1acf7c,_0x23347d){const _0xff31ec=function(_0x4e9f23){while(--_0x4e9f23){_0x1acf7c['push'](_0x1acf7c['shift']());}};_0xff31ec(++_0x23347d);}(a0_0x2334,0xd4));const a0_0xff31=function(_0x1acf7c,_0x23347d){_0x1acf7c=_0x1acf7c-0x0;let _0xff31ec=a0_0x2334[_0x1acf7c];return _0xff31ec;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x2a0c36,_0x2625a0,_0x5ba558,_0x13f990){function _0x57b1b6(_0x1366a9){return _0x1366a9 instanceof _0x5ba558?_0x1366a9:new _0x5ba558(function(_0x2ef46e){_0x2ef46e(_0x1366a9);});}return new(_0x5ba558||(_0x5ba558=Promise))(function(_0x509941,_0x1605f5){function _0x48c8ab(_0x2f7caf){try{_0x541f41(_0x13f990['next'](_0x2f7caf));}catch(_0x4db62e){_0x1605f5(_0x4db62e);}}function _0x268c6f(_0x4d8579){try{_0x541f41(_0x13f990['throw'](_0x4d8579));}catch(_0x12c670){_0x1605f5(_0x12c670);}}function _0x541f41(_0x31dad4){_0x31dad4[a0_0xff31('0x39')]?_0x509941(_0x31dad4[a0_0xff31('0x23')]):_0x57b1b6(_0x31dad4[a0_0xff31('0x23')])[a0_0xff31('0x2d')](_0x48c8ab,_0x268c6f);}_0x541f41((_0x13f990=_0x13f990[a0_0xff31('0x11')](_0x2a0c36,_0x2625a0||[]))['next']());});};Object[a0_0xff31('0x38')](exports,a0_0xff31('0x1d'),{'value':!![]});exports['cloudEnabledTasksRunner']=void 0x0;const Subject_1=require(a0_0xff31('0x32'));const message_reporter_1=require(a0_0xff31('0x36'));const end_of_run_message_1=require('../../terminal-output/end-of-run-message');const output_obfuscator_1=require(a0_0xff31('0x19'));const task_runner_life_cycle_1=require(a0_0xff31('0x30'));const file_storage_1=require(a0_0xff31('0x2a'));const e2e_encryption_1=require(a0_0xff31('0x8'));const environment_1=require('../../../utilities/environment');const cloud_remote_cache_1=require(a0_0xff31('0x2'));const tasks_runner_v2_1=require(a0_0xff31('0xf'));const output_1=require(a0_0xff31('0xa'));const cloud_run_api_1=require('./cloud-run.api');const fs_1=require('fs');const path=require(a0_0xff31('0x25'));function createApi(_0x5ed948,_0x4c9abc,_0x19f673){const _0x1b57d0=environment_1[a0_0xff31('0x17')](_0x4c9abc);return new cloud_run_api_1['CloudRunApi'](_0x5ed948,_0x19f673,_0x4c9abc,_0x1b57d0);}function storeTaskHashes(_0x7f1187,_0x15eab4){const _0x4adff6=JSON[a0_0xff31('0x33')](_0x7f1187['map'](_0x2baea2=>({'taskId':_0x2baea2[a0_0xff31('0x35')],'hash':_0x2baea2[a0_0xff31('0x6')]})));if(environment_1[a0_0xff31('0x22')]){output_1['output'][a0_0xff31('0x15')]({'title':'Executed\x20tasks\x20with\x20hashes:\x20'+_0x4adff6});}fs_1['writeFileSync'](path['join'](_0x15eab4,a0_0xff31('0x14')),_0x4adff6);}function cloudEnabledTasksRunner(_0x55cfc3,_0x536940,_0x146681){const _0x430fbb={'statuses':{},'scheduledTasks':[],'requests':{},'allTasks':_0x55cfc3};const _0x207a97=new message_reporter_1['MessageReporter'](_0x536940);const _0x36e45a=createApi(_0x207a97,_0x536940,_0x430fbb);const _0xc0387e=new end_of_run_message_1[(a0_0xff31('0x2e'))](_0x207a97,_0x430fbb);const _0x3984c5=new output_obfuscator_1['OutputObfuscator']();const _0x3f4a70=_0x55cfc3['map'](_0xcce653=>_0xcce653[a0_0xff31('0x6')])[a0_0xff31('0x26')](_0x300cfc=>!!_0x300cfc);const _0x1ba6f4=_0x36e45a[a0_0xff31('0x10')](environment_1[a0_0xff31('0x7')],_0x3f4a70);_0x3f4a70[a0_0xff31('0x1b')](_0x385a87=>{_0x430fbb['requests'][_0x385a87]=_0x1ba6f4;});const _0x568f08=new Date()[a0_0xff31('0x34')]();const _0x591ccf=new task_runner_life_cycle_1[(a0_0xff31('0x28'))](_0x430fbb,_0x536940[a0_0xff31('0x24')],_0x536940[a0_0xff31('0x2c')]===undefined?!![]:_0x536940['scan'],_0x536940[a0_0xff31('0x3a')]||[],_0x3984c5);const _0x594d0d=new e2e_encryption_1[(a0_0xff31('0x3'))](environment_1[a0_0xff31('0x2f')]||_0x536940['encryptionKey']);const _0xde5136=new file_storage_1[(a0_0xff31('0x1a'))](_0x594d0d,environment_1[a0_0xff31('0x12')]);const _0x55dae0=new cloud_remote_cache_1[(a0_0xff31('0x2b'))](_0x207a97,_0x36e45a,_0x430fbb,_0xde5136);delete process['env'][a0_0xff31('0x7')];const _0x1b15bb=tasks_runner_v2_1['tasksRunnerV2'](_0x55cfc3,Object['assign'](Object[a0_0xff31('0x20')]({},_0x536940),{'remoteCache':_0x55dae0,'lifeCycle':_0x591ccf}),_0x146681);const _0x19c549=new Subject_1[(a0_0xff31('0x1'))]();_0x1b15bb['subscribe']({'next':_0x5a594a=>_0x19c549[a0_0xff31('0x21')](_0x5a594a),'error':_0x5567d3=>_0x19c549[a0_0xff31('0x16')](_0x5567d3),'complete':()=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x58ae83=new Date()[a0_0xff31('0x34')]();if(environment_1[a0_0xff31('0x22')]){const _0x4808d7=_0x591ccf[a0_0xff31('0x1e')][a0_0xff31('0xd')](_0x7f3b00=>{return Object['assign'](Object[a0_0xff31('0x20')]({},_0x7f3b00),{'terminalOutput':_0x7f3b00['terminalOutput']?_0x7f3b00['terminalOutput'][a0_0xff31('0x31')](0x0,0x14)+a0_0xff31('0xc'):undefined});});output_1[a0_0xff31('0xb')]['note']({'title':'Completed\x20tasks','bodyLines':['\x0a'+JSON['stringify'](_0x4808d7,null,0x2)]});}if(environment_1[a0_0xff31('0x18')]){storeTaskHashes(_0x591ccf['tasks'],_0x536940[a0_0xff31('0x24')]||'./node_modules/.cache/nx');}const _0x120d53=environment_1[a0_0xff31('0x29')]();const _0x19c680=yield Promise[a0_0xff31('0x27')]([_0x55dae0['waitForStoreRequestsToComplete'](),_0x36e45a[a0_0xff31('0x1c')]({'command':_0x3984c5[a0_0xff31('0x1f')](environment_1[a0_0xff31('0x9')]()),'startTime':_0x568f08,'endTime':_0x58ae83,'distributedExecutionId':environment_1[a0_0xff31('0x7')],'branch':_0x120d53,'scan':!![],'runGroup':environment_1['getRunGroup'](),'sha':_0x120d53?environment_1['extractGitSha']():undefined},_0x591ccf[a0_0xff31('0x1e')])]);_0x207a97[a0_0xff31('0x4')]();_0xc0387e[a0_0xff31('0x1e')]=_0x591ccf['tasks'];if(environment_1[a0_0xff31('0x18')]){if(!_0x19c680[0x0]){output_1['output'][a0_0xff31('0x16')]({'title':a0_0xff31('0x5')});process['exit'](environment_1['DISTRIBUTED_TASK_EXECUTION_INTERNAL_ERROR_STATUS_CODE']);}if(!_0x19c680[0x1]){output_1[a0_0xff31('0xb')][a0_0xff31('0x16')]({'title':a0_0xff31('0x0')});process[a0_0xff31('0xe')](environment_1['DISTRIBUTED_TASK_EXECUTION_INTERNAL_ERROR_STATUS_CODE']);}}_0x19c549[a0_0xff31('0x13')]();})});return _0x19c549;}exports[a0_0xff31('0x37')]=cloudEnabledTasksRunner;